import{s as E}from"../chunks/supabaseClient.DvHc7uqV.js";import{s as M,e as P,t as $,a as B,c as w,b as C,d as I,f as _,g as F,l as q,i as v,h,j as L,n as g,m as j,o as U,H as G,q as J}from"../chunks/scheduler.DBuKuVba.js";import{h as A,u as R}from"../chunks/await_block.CtqnqUU4.js";import{e as Q}from"../chunks/each.D6YF6ztN.js";import{S as W,i as X,t as y,a as S,g as Y,c as Z,b as O,d as T,m as V,e as z}from"../chunks/index.CsvtYcO8.js";import{g as D,P as x}from"../chunks/shops.BgBrHpI7.js";import{S as ee}from"../chunks/Spinner.BpP10mi9.js";async function te(r){console.log("getProductIdsFromCatid, ",r);let t=[];const{data:o,error:n}=await E.from("productscategoryview").select("id").eq("category_id",r);return n?console.log("Fehler beim Abrufen der ProductIds(catId): ",n):t=o.map(e=>e.id),t}function ae(){return[{id:5,name:"Ayurveda"},{id:6,name:"Aphrodisiaka"}]}async function re(r){const{count:t}=await E.from("products_categories").select("*",{count:"exact",head:!0}).eq("category_id",r);return t}async function oe(r){const{data:t}=await E.from("categories").select("name").eq("id",r);return t[0].name}async function ne(r){const{data:t,error:o}=await E.from("products").select().in("id",r).order("name");return o?null:t}async function le({params:r}){const t=r.catid,o=await te(parseInt(t)),n=await re(parseInt(t)),e=await oe(parseInt(t)),d=ae();return{data:{catid:t,catname:e,productcategories:d,productQty:n},streamed:{products:ne(o)}}}const ke=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"}));function K(r,t,o){const n=r.slice();return n[3]=t[o],n}function ce(r){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function se(r){let t,o,n=Q(r[2]),e=[];for(let a=0;a<n.length;a+=1)e[a]=N(K(r,n,a));const d=a=>S(e[a],1,1,()=>{e[a]=null});return{c(){for(let a=0;a<e.length;a+=1)e[a].c();t=j()},l(a){for(let c=0;c<e.length;c+=1)e[c].l(a);t=j()},m(a,c){for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(a,c);v(a,t,c),o=!0},p(a,c){if(c&1){n=Q(a[2]);let l;for(l=0;l<n.length;l+=1){const s=K(a,n,l);e[l]?(e[l].p(s,c),y(e[l],1)):(e[l]=N(s),e[l].c(),y(e[l],1),e[l].m(t.parentNode,t))}for(Y(),l=n.length;l<e.length;l+=1)d(l);Z()}},i(a){if(!o){for(let c=0;c<n.length;c+=1)y(e[c]);o=!0}},o(a){e=e.filter(Boolean);for(let c=0;c<e.length;c+=1)S(e[c]);o=!1},d(a){a&&_(t),U(e,a)}}}function N(r){let t,o,n,e=D(r[3].id)+"",d,a,c,l;return a=new x({props:{product:{id:r[3].id,name:r[3].name,img:r[3].image}}}),{c(){t=P("div"),o=P("li"),n=new G(!1),d=B(),O(a.$$.fragment),c=B(),this.h()},l(s){t=w(s,"DIV",{class:!0});var i=C(t);o=w(i,"LI",{class:!0});var p=C(o);n=J(p,!1),d=F(p),T(a.$$.fragment,p),p.forEach(_),c=F(i),i.forEach(_),this.h()},h(){n.a=d,q(o,"class","my-2 relative"),q(t,"class","")},m(s,i){v(s,t,i),h(t,o),n.m(e,o),h(o,d),V(a,o,null),h(t,c),l=!0},p(s,i){(!l||i&1)&&e!==(e=D(s[3].id)+"")&&n.p(e);const p={};i&1&&(p.product={id:s[3].id,name:s[3].name,img:s[3].image}),a.$set(p)},i(s){l||(y(a.$$.fragment,s),l=!0)},o(s){S(a.$$.fragment,s),l=!1},d(s){s&&_(t),z(a)}}}function ie(r){let t,o,n;return t=new ee({}),{c(){O(t.$$.fragment),o=$(`
          Lade Produkte ...`)},l(e){T(t.$$.fragment,e),o=I(e,`
          Lade Produkte ...`)},m(e,d){V(t,e,d),v(e,o,d),n=!0},p:g,i(e){n||(y(t.$$.fragment,e),n=!0)},o(e){S(t.$$.fragment,e),n=!1},d(e){e&&_(o),z(t,e)}}}function de(r){let t,o,n=r[0].data.productQty+"",e,d,a=r[0].data.catname+"",c,l,s,i,p,k,u={ctx:r,current:null,token:null,hasCatch:!1,pending:ie,then:se,catch:ce,value:2,blocks:[,,,]};return A(p=r[0].streamed.products,u),{c(){t=P("div"),o=P("h2"),e=$(n),d=$(" Produkte der Kategorie  "),c=$(a),l=$(" gefunden"),s=B(),i=P("ul"),u.block.c(),this.h()},l(f){t=w(f,"DIV",{class:!0});var m=C(t);o=w(m,"H2",{});var b=C(o);e=I(b,n),d=I(b," Produkte der Kategorie  "),c=I(b,a),l=I(b," gefunden"),b.forEach(_),m.forEach(_),s=F(f),i=w(f,"UL",{class:!0});var H=C(i);u.block.l(H),H.forEach(_),this.h()},h(){q(t,"class","px-2 m-2 border-2 "),q(i,"class","grid grid-cols-2 md:grid-cols-3")},m(f,m){v(f,t,m),h(t,o),h(o,e),h(o,d),h(o,c),h(o,l),v(f,s,m),v(f,i,m),u.block.m(i,u.anchor=null),u.mount=()=>i,u.anchor=null,k=!0},p(f,[m]){r=f,(!k||m&1)&&n!==(n=r[0].data.productQty+"")&&L(e,n),(!k||m&1)&&a!==(a=r[0].data.catname+"")&&L(c,a),u.ctx=r,m&1&&p!==(p=r[0].streamed.products)&&A(p,u)||R(u,r,m)},i(f){k||(y(u.block),k=!0)},o(f){for(let m=0;m<3;m+=1){const b=u.blocks[m];S(b)}k=!1},d(f){f&&(_(t),_(s),_(i)),u.block.d(),u.token=null,u=null}}}function ue(r,t,o){let{data:n}=t;return r.$$set=e=>{"data"in e&&o(0,n=e.data)},r.$$.update=()=>{r.$$.dirty&1&&n.data.catid},[n]}class ve extends W{constructor(t){super(),X(this,t,ue,de,M,{data:0})}}export{ve as component,ke as universal};
