import{s as se,d as Ee,c as Be,b as De,h as R,u as me,S as $e}from"../chunks/books.BjRiXvPo.js";import{s as Ve,e as g,a as V,t as q,M as we,c as b,b as $,f as c,g as C,d as F,N as Ie,L as _e,l as u,E as ge,i as d,h as _,j as oe,n as m,o as N,m as ye}from"../chunks/scheduler.TcPaG1AO.js";import{e as W}from"../chunks/each.D6YF6ztN.js";import{S as Ce,i as He,b as X,d as Y,m as Z,t as E,a as H,e as ee,g as Le,c as Se}from"../chunks/index.eDZ0B_bf.js";import{B as xe}from"../chunks/Button.yyXqLmPo.js";import{g as je,B as qe}from"../chunks/book.D_yoPbWw.js";async function Fe(r){try{const{data:l}=await se.from("books").select("*").eq("id",r).limit(1).single();return{data:l}}catch{return{}}}async function Te(r){const{data:l,error:t}=await se.from("books_hashtags").select("hashtag_id").eq("book_id",r);if(t)throw new Error("Fehler beim Abrufen der Hashtags: "+t.message);return l.map(e=>e.hashtag_id)}async function Ae(r){const{data:l,error:t}=await se.from("hashtags").select("tag").in("id",r);if(t)throw new Error("Fehler beim Abrufen der Hashtags: "+t.message);return l}async function Me({params:r}){let l=parseInt(r.bookId),{data:t}=await Fe(l),s=await Te(l),e=await Ee(s);return{data:t,streamed:{similarBooks:Be(e),hashtags:Ae(s),bookcategories:De()}}}const lt=Object.freeze(Object.defineProperty({__proto__:null,load:Me},Symbol.toStringTag,{value:"Module"}));function be(r,l,t){const s=r.slice();return s[6]=l[t],s}function pe(r,l,t){const s=r.slice();return s[10]=l[t],s}function Ne(r){let l=r[1].title+"",t,s;return{c(){t=q(l),s=q(" ðŸ›’")},l(e){t=F(e,l),s=F(e," ðŸ›’")},m(e,o){d(e,t,o),d(e,s,o)},p(e,o){o&2&&l!==(l=e[1].title+"")&&oe(t,l)},d(e){e&&(c(t),c(s))}}}function Oe(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Pe(r){let l,t=W(r[9]),s=[];for(let e=0;e<t.length;e+=1)s[e]=ke(pe(r,t,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();l=N()},l(e){for(let o=0;o<s.length;o+=1)s[o].l(e);l=N()},m(e,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,o);d(e,l,o)},p(e,o){if(o&1){t=W(e[9]);let a;for(a=0;a<t.length;a+=1){const n=pe(e,t,a);s[a]?s[a].p(n,o):(s[a]=ke(n),s[a].c(),s[a].m(l.parentNode,l))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},i:m,o:m,d(e){e&&c(l),ye(s,e)}}}function ke(r){let l,t=r[10].tag+"",s,e,o,a;return{c(){l=q("#"),s=q(t),e=V(),o=new we(!1),a=N(),this.h()},l(n){l=F(n,"#"),s=F(n,t),e=C(n),o=Ie(n,!1),a=N(),this.h()},h(){o.a=a},m(n,i){d(n,l,i),d(n,s,i),d(n,e,i),o.m(Qe,n,i),d(n,a,i)},p(n,i){i&1&&t!==(t=n[10].tag+"")&&oe(s,t)},d(n){n&&(c(l),c(s),c(e),c(a),o.d())}}}function ze(r){let l,t,s,e;return t=new $e({}),{c(){l=g("div"),X(t.$$.fragment),s=q(`
                    Loading hashtags ...`),this.h()},l(o){l=b(o,"DIV",{class:!0});var a=$(l);Y(t.$$.fragment,a),s=F(a,`
                    Loading hashtags ...`),a.forEach(c),this.h()},h(){u(l,"class","loading")},m(o,a){d(o,l,a),Z(t,l,null),_(l,s),e=!0},p:m,i(o){e||(E(t.$$.fragment,o),e=!0)},o(o){H(t.$$.fragment,o),e=!1},d(o){o&&c(l),ee(t)}}}function Ge(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Ue(r){let l,t,s=W(r[5]),e=[];for(let a=0;a<s.length;a+=1)e[a]=ve(be(r,s,a));const o=a=>H(e[a],1,1,()=>{e[a]=null});return{c(){for(let a=0;a<e.length;a+=1)e[a].c();l=N()},l(a){for(let n=0;n<e.length;n+=1)e[n].l(a);l=N()},m(a,n){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(a,n);d(a,l,n),t=!0},p(a,n){if(n&1){s=W(a[5]);let i;for(i=0;i<s.length;i+=1){const T=be(a,s,i);e[i]?(e[i].p(T,n),E(e[i],1)):(e[i]=ve(T),e[i].c(),E(e[i],1),e[i].m(l.parentNode,l))}for(Le(),i=s.length;i<e.length;i+=1)o(i);Se()}},i(a){if(!t){for(let n=0;n<s.length;n+=1)E(e[n]);t=!0}},o(a){e=e.filter(Boolean);for(let n=0;n<e.length;n+=1)H(e[n]);t=!1},d(a){a&&c(l),ye(e,a)}}}function ve(r){let l,t,s;return t=new qe({props:{book:{id:r[6].id,title:r[6].title,img:r[6].img}}}),{c(){l=g("li"),X(t.$$.fragment),this.h()},l(e){l=b(e,"LI",{class:!0});var o=$(l);Y(t.$$.fragment,o),o.forEach(c),this.h()},h(){u(l,"class","my-2")},m(e,o){d(e,l,o),Z(t,l,null),s=!0},p(e,o){const a={};o&1&&(a.book={id:e[6].id,title:e[6].title,img:e[6].img}),t.$set(a)},i(e){s||(E(t.$$.fragment,e),s=!0)},o(e){H(t.$$.fragment,e),s=!1},d(e){e&&c(l),ee(t)}}}function Je(r){let l,t,s,e;return t=new $e({}),{c(){l=g("div"),X(t.$$.fragment),s=q(`
            Loading similar books ...`),this.h()},l(o){l=b(o,"DIV",{class:!0});var a=$(l);Y(t.$$.fragment,a),s=F(a,`
            Loading similar books ...`),a.forEach(c),this.h()},h(){u(l,"class","loading")},m(o,a){d(o,l,a),Z(t,l,null),_(l,s),e=!0},p:m,i(o){e||(E(t.$$.fragment,o),e=!0)},o(o){H(t.$$.fragment,o),e=!1},d(o){o&&c(l),ee(t)}}}function Ke(r){let l,t,s,e,o,a,n=r[1].title+"",i,T,A,O,te,M,B,D,P,z,w,L,re="StichwÃ¶rter:",le,S,G,U,I,x,ne="Ã„hnliche BÃ¼cher:",ae,j,J,y;D=new xe({props:{class:"text-lg",color:"green",$$slots:{default:[Ne]},$$scope:{ctx:r}}});let p={ctx:r,current:null,token:null,hasCatch:!1,pending:ze,then:Pe,catch:Oe,value:9,blocks:[,,,]};R(G=r[0].streamed.hashtags,p);let k={ctx:r,current:null,token:null,hasCatch:!1,pending:Je,then:Ue,catch:Ge,value:5,blocks:[,,,]};return R(J=r[0].streamed.similarBooks,k),{c(){l=g("div"),t=g("img"),e=V(),o=g("div"),a=g("h2"),i=q(n),T=V(),A=g("div"),O=new we(!1),te=V(),M=g("div"),B=g("a"),X(D.$$.fragment),z=V(),w=g("div"),L=g("div"),L.textContent=re,le=V(),S=g("div"),p.block.c(),U=V(),I=g("div"),x=g("div"),x.textContent=ne,ae=V(),j=g("ul"),k.block.c(),this.h()},l(f){l=b(f,"DIV",{class:!0});var h=$(l);t=b(h,"IMG",{class:!0,width:!0,alt:!0,src:!0}),h.forEach(c),e=C(f),o=b(f,"DIV",{class:!0});var v=$(o);a=b(v,"H2",{class:!0});var ie=$(a);i=F(ie,n),ie.forEach(c),T=C(v),A=b(v,"DIV",{class:!0});var ce=$(A);O=Ie(ce,!1),ce.forEach(c),te=C(v),M=b(v,"DIV",{class:!0});var he=$(M);B=b(he,"A",{href:!0,target:!0});var fe=$(B);Y(D.$$.fragment,fe),fe.forEach(c),he.forEach(c),v.forEach(c),z=C(f),w=b(f,"DIV",{class:!0});var K=$(w);L=b(K,"DIV",{class:!0,"data-svelte-h":!0}),_e(L)!=="svelte-ooggy2"&&(L.textContent=re),le=C(K),S=b(K,"DIV",{class:!0});var ue=$(S);p.block.l(ue),ue.forEach(c),K.forEach(c),U=C(f),I=b(f,"DIV",{class:!0});var Q=$(I);x=b(Q,"DIV",{class:!0,"data-svelte-h":!0}),_e(x)!=="svelte-nfoxyh"&&(x.textContent=ne),ae=C(Q),j=b(Q,"UL",{class:!0});var de=$(j);k.block.l(de),de.forEach(c),Q.forEach(c),this.h()},h(){u(t,"class","py-10"),u(t,"width","400"),u(t,"alt",r[4]),ge(t.src,s=r[3])||u(t,"src",s),u(l,"class","w-full flex flex-row bg-gray-100 justify-center"),u(a,"class","bg-yellow-300 p-2"),O.a=null,u(A,"class","p-5"),u(B,"href",P=r[1].link),u(B,"target","_blank"),u(M,"class","my-5 pb-10 flex flex-col items-center "),u(o,"class","bg-yellow-100"),u(L,"class","p-2 w-full mt-5 bg-teal-300 text-lg font-bold text-center"),u(S,"class","p-5 flex flex-row justify-center "),u(w,"class","bg-teal-100"),u(x,"class","w-full my-5 bg-lime-300 p-3 text-lg font-bold text-center"),u(j,"class","grid grid-cols-2 md:grid-cols-3"),u(I,"class","bg-lime-100")},m(f,h){d(f,l,h),_(l,t),d(f,e,h),d(f,o,h),_(o,a),_(a,i),_(o,T),_(o,A),O.m(r[2],A),_(o,te),_(o,M),_(M,B),Z(D,B,null),d(f,z,h),d(f,w,h),_(w,L),_(w,le),_(w,S),p.block.m(S,p.anchor=null),p.mount=()=>S,p.anchor=null,d(f,U,h),d(f,I,h),_(I,x),_(I,ae),_(I,j),k.block.m(j,k.anchor=null),k.mount=()=>j,k.anchor=null,y=!0},p(f,[h]){r=f,(!y||h&16)&&u(t,"alt",r[4]),(!y||h&8&&!ge(t.src,s=r[3]))&&u(t,"src",s),(!y||h&2)&&n!==(n=r[1].title+"")&&oe(i,n),(!y||h&4)&&O.p(r[2]);const v={};h&8194&&(v.$$scope={dirty:h,ctx:r}),D.$set(v),(!y||h&2&&P!==(P=r[1].link))&&u(B,"href",P),p.ctx=r,h&1&&G!==(G=r[0].streamed.hashtags)&&R(G,p)||me(p,r,h),k.ctx=r,h&1&&J!==(J=r[0].streamed.similarBooks)&&R(J,k)||me(k,r,h)},i(f){y||(E(D.$$.fragment,f),E(p.block),E(k.block),y=!0)},o(f){H(D.$$.fragment,f);for(let h=0;h<3;h+=1){const v=p.blocks[h];H(v)}for(let h=0;h<3;h+=1){const v=k.blocks[h];H(v)}y=!1},d(f){f&&(c(l),c(e),c(o),c(z),c(w),c(U),c(I)),ee(D),p.block.d(),p.token=null,p=null,k.block.d(),k.token=null,k=null}}}const Qe="&#x20;";function Re(r,l,t){let s,e,o,a,{data:n}=l;return r.$$set=i=>{"data"in i&&t(0,n=i.data)},r.$$.update=()=>{r.$$.dirty&1&&t(1,s=n.data),r.$$.dirty&2&&t(4,e=s.title),r.$$.dirty&2&&t(3,o=je(s.img[0],s.id)),r.$$.dirty&2&&t(2,a=s.desc)},[n,s,a,o,e]}class at extends Ce{constructor(l){super(),He(this,l,Re,Ke,Ve,{data:0})}}export{at as component,lt as universal};
