import{s as q}from"../chunks/supabaseClient.DvHc7uqV.js";import{s as J,e as $,t as I,a as B,c as w,b as C,d as P,f as g,g as F,l as E,i as b,h,j as H,n as k,m as j,o as R,H as W,q as X}from"../chunks/scheduler.DBuKuVba.js";import{h as A,u as Y}from"../chunks/await_block.CtqnqUU4.js";import{e as K}from"../chunks/each.D6YF6ztN.js";import{S as Z,i as x,t as D,a as S,g as ee,c as te,b as T,d as M,m as U,e as G}from"../chunks/index.CsvtYcO8.js";import{g as N,P as ae}from"../chunks/shops.BgBrHpI7.js";import{S as re}from"../chunks/Spinner.BpP10mi9.js";async function oe(a){const{data:t,error:r}=await q.from("categories").select("description").eq("id",a).single();try{return t&&t.description?t.description:null}catch{return null}}async function ne(a){console.log("getProductIdsFromCatid, ",a);let t=[];const{data:r,error:o}=await q.from("productscategoryview").select("id").eq("category_id",a);return o?console.log("Fehler beim Abrufen der ProductIds(catId): ",o):t=r.map(e=>e.id),t}function ie(){return[{id:5,name:"Ayurveda"},{id:6,name:"Aphrodisiaka"}]}async function le(a){const{count:t}=await q.from("products_categories").select("*",{count:"exact",head:!0}).eq("category_id",a);return t}async function se(a){const{data:t}=await q.from("categories").select("name").eq("id",a);return t[0].name}async function ce(a){const{data:t,error:r}=await q.from("products").select().in("id",a).order("name");return r?null:t}async function de({params:a}){const t=a.catid,r=await ne(parseInt(t)),o=await le(parseInt(t)),e=await se(parseInt(t)),c=ie(),n=await oe(parseInt(t)),l=`${e} - CDL Protokolle`,i=n||`Entdecken Sie eine Vielzahl von Produkten in der Kategorie ${e} auf CDL Protokolle.`;return{data:{catid:t,catname:e,productcategories:c,productQty:o,description:n,title:l,metaDescription:i},streamed:{products:ce(r)}}}const Pe=Object.freeze(Object.defineProperty({__proto__:null,load:de},Symbol.toStringTag,{value:"Module"}));function Q(a,t,r){const o=a.slice();return o[4]=t[r],o}function z(a){let t,r;return{c(){t=$("div"),r=I(a[1]),this.h()},l(o){t=w(o,"DIV",{id:!0});var e=C(t);r=P(e,a[1]),e.forEach(g),this.h()},h(){E(t,"id","description")},m(o,e){b(o,t,e),h(t,r)},p(o,e){e&2&&H(r,o[1])},d(o){o&&g(t)}}}function ue(a){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function fe(a){let t,r,o=K(a[3]),e=[];for(let n=0;n<o.length;n+=1)e[n]=O(Q(a,o,n));const c=n=>S(e[n],1,1,()=>{e[n]=null});return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=j()},l(n){for(let l=0;l<e.length;l+=1)e[l].l(n);t=j()},m(n,l){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(n,l);b(n,t,l),r=!0},p(n,l){if(l&1){o=K(n[3]);let i;for(i=0;i<o.length;i+=1){const s=Q(n,o,i);e[i]?(e[i].p(s,l),D(e[i],1)):(e[i]=O(s),e[i].c(),D(e[i],1),e[i].m(t.parentNode,t))}for(ee(),i=o.length;i<e.length;i+=1)c(i);te()}},i(n){if(!r){for(let l=0;l<o.length;l+=1)D(e[l]);r=!0}},o(n){e=e.filter(Boolean);for(let l=0;l<e.length;l+=1)S(e[l]);r=!1},d(n){n&&g(t),R(e,n)}}}function O(a){let t,r,o,e=N(a[4].id)+"",c,n,l,i;return n=new ae({props:{product:{id:a[4].id,name:a[4].name,img:a[4].image}}}),{c(){t=$("div"),r=$("li"),o=new W(!1),c=B(),T(n.$$.fragment),l=B(),this.h()},l(s){t=w(s,"DIV",{class:!0});var p=C(t);r=w(p,"LI",{class:!0});var f=C(r);o=X(f,!1),c=F(f),M(n.$$.fragment,f),f.forEach(g),l=F(p),p.forEach(g),this.h()},h(){o.a=c,E(r,"class","my-2 relative"),E(t,"class","")},m(s,p){b(s,t,p),h(t,r),o.m(e,r),h(r,c),U(n,r,null),h(t,l),i=!0},p(s,p){(!i||p&1)&&e!==(e=N(s[4].id)+"")&&o.p(e);const f={};p&1&&(f.product={id:s[4].id,name:s[4].name,img:s[4].image}),n.$set(f)},i(s){i||(D(n.$$.fragment,s),i=!0)},o(s){S(n.$$.fragment,s),i=!1},d(s){s&&g(t),G(n)}}}function me(a){let t,r,o;return t=new re({}),{c(){T(t.$$.fragment),r=I(`
          Lade Produkte ...`)},l(e){M(t.$$.fragment,e),r=P(e,`
          Lade Produkte ...`)},m(e,c){U(t,e,c),b(e,r,c),o=!0},p:k,i(e){o||(D(t.$$.fragment,e),o=!0)},o(e){S(t.$$.fragment,e),o=!1},d(e){e&&g(r),G(t,e)}}}function pe(a){let t,r,o=a[0].data.productQty+"",e,c,n=a[0].data.catname+"",l,i,s,p,f,L,y,m=a[1]&&z(a),_={ctx:a,current:null,token:null,hasCatch:!1,pending:me,then:fe,catch:ue,value:3,blocks:[,,,]};return A(L=a[0].streamed.products,_),{c(){t=$("div"),r=$("h2"),e=I(o),c=I(" Produkte der Kategorie  "),l=I(n),i=I(" gefunden"),s=B(),m&&m.c(),p=B(),f=$("ul"),_.block.c(),this.h()},l(d){t=w(d,"DIV",{class:!0});var u=C(t);r=w(u,"H2",{});var v=C(r);e=P(v,o),c=P(v," Produkte der Kategorie  "),l=P(v,n),i=P(v," gefunden"),v.forEach(g),u.forEach(g),s=F(d),m&&m.l(d),p=F(d),f=w(d,"UL",{class:!0});var V=C(f);_.block.l(V),V.forEach(g),this.h()},h(){E(t,"class","px-2 m-2 border-2 "),E(f,"class","grid grid-cols-2 md:grid-cols-3")},m(d,u){b(d,t,u),h(t,r),h(r,e),h(r,c),h(r,l),h(r,i),b(d,s,u),m&&m.m(d,u),b(d,p,u),b(d,f,u),_.block.m(f,_.anchor=null),_.mount=()=>f,_.anchor=null,y=!0},p(d,[u]){a=d,(!y||u&1)&&o!==(o=a[0].data.productQty+"")&&H(e,o),(!y||u&1)&&n!==(n=a[0].data.catname+"")&&H(l,n),a[1]?m?m.p(a,u):(m=z(a),m.c(),m.m(p.parentNode,p)):m&&(m.d(1),m=null),_.ctx=a,u&1&&L!==(L=a[0].streamed.products)&&A(L,_)||Y(_,a,u)},i(d){y||(D(_.block),y=!0)},o(d){for(let u=0;u<3;u+=1){const v=_.blocks[u];S(v)}y=!1},d(d){d&&(g(t),g(s),g(p),g(f)),m&&m.d(d),_.block.d(),_.token=null,_=null}}}function _e(a,t,r){let o,{data:e}=t;return a.$$set=c=>{"data"in c&&r(0,e=c.data)},a.$$.update=()=>{a.$$.dirty&1&&e.data.catid,a.$$.dirty&1&&r(1,o=e.data.description)},[e,o]}class $e extends Z{constructor(t){super(),x(this,t,_e,pe,J,{data:0})}}export{$e as component,Pe as universal};
