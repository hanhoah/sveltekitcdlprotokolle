import{s as q}from"../chunks/supabaseClient.CD4MZNEJ.js";import{s as H,e as w,t as $,a as M,c as C,b as S,d as v,f as m,g as T,l as E,i as b,h as y,j as L,n as p,m as j,o as U}from"../chunks/scheduler.MvcK4Jfn.js";import{h as A,u as V}from"../chunks/await_block.DbglkfJ3.js";import{e as B}from"../chunks/each.D6YF6ztN.js";import{S as G,i as J,t as k,a as I,g as R,c as W,b as N,d as O,m as z,e as D}from"../chunks/index.kA7WmQLO.js";import{P as X}from"../chunks/product.PPEkn7lc.js";import{S as Y}from"../chunks/Spinner.BHdm9wUT.js";async function Z(a){console.log("getProductIdsFromCatid, ",a);let t=[];const{data:r,error:o}=await q.from("products_categories").select("product_id").eq("category_id",a);return o?console.log("Fehler beim Abrufen der ProductIds(catId)"):t=[...new Set(r.map(e=>e.product_id))],t}function x(){return[{id:5,name:"Ayurveda"},{id:6,name:"Aphrodisiaka"}]}async function ee(a){const{count:t}=await q.from("products_categories").select("*",{count:"exact",head:!0}).eq("category_id",a);return t}async function te(a){const{data:t}=await q.from("categories").select("name").eq("id",a);return t[0].name}async function ae(a){const{data:t,error:r}=await q.from("products").select().in("id",a);return r?null:t}async function re({params:a}){const t=a.catid,r=await Z(parseInt(t)),o=await ee(parseInt(t)),e=await te(parseInt(t)),l=x();return{data:{catid:t,catname:e,productcategories:l,productQty:o},streamed:{products:ae(r)}}}const ge=Object.freeze(Object.defineProperty({__proto__:null,load:re},Symbol.toStringTag,{value:"Module"}));function Q(a,t,r){const o=a.slice();return o[3]=t[r],o}function oe(a){return{c:p,l:p,m:p,p,i:p,o:p,d:p}}function ne(a){let t,r,o=B(a[2]),e=[];for(let n=0;n<o.length;n+=1)e[n]=K(Q(a,o,n));const l=n=>I(e[n],1,1,()=>{e[n]=null});return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=j()},l(n){for(let s=0;s<e.length;s+=1)e[s].l(n);t=j()},m(n,s){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(n,s);b(n,t,s),r=!0},p(n,s){if(s&1){o=B(n[2]);let c;for(c=0;c<o.length;c+=1){const _=Q(n,o,c);e[c]?(e[c].p(_,s),k(e[c],1)):(e[c]=K(_),e[c].c(),k(e[c],1),e[c].m(t.parentNode,t))}for(R(),c=o.length;c<e.length;c+=1)l(c);W()}},i(n){if(!r){for(let s=0;s<o.length;s+=1)k(e[s]);r=!0}},o(n){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)I(e[s]);r=!1},d(n){n&&m(t),U(e,n)}}}function K(a){let t,r,o;return r=new X({props:{product:{id:a[3].id,name:a[3].name,img:a[3].image}}}),{c(){t=w("li"),N(r.$$.fragment),this.h()},l(e){t=C(e,"LI",{class:!0});var l=S(t);O(r.$$.fragment,l),l.forEach(m),this.h()},h(){E(t,"class","my-2")},m(e,l){b(e,t,l),z(r,t,null),o=!0},p(e,l){const n={};l&1&&(n.product={id:e[3].id,name:e[3].name,img:e[3].image}),r.$set(n)},i(e){o||(k(r.$$.fragment,e),o=!0)},o(e){I(r.$$.fragment,e),o=!1},d(e){e&&m(t),D(r)}}}function ce(a){let t,r,o;return t=new Y({}),{c(){N(t.$$.fragment),r=$(`
          Lade Produkte ...`)},l(e){O(t.$$.fragment,e),r=v(e,`
          Lade Produkte ...`)},m(e,l){z(t,e,l),b(e,r,l),o=!0},p,i(e){o||(k(t.$$.fragment,e),o=!0)},o(e){I(t.$$.fragment,e),o=!1},d(e){e&&m(r),D(t,e)}}}function se(a){let t,r,o=a[0].data.productQty+"",e,l,n=a[0].data.catname+"",s,c,_,f,P,h,i={ctx:a,current:null,token:null,hasCatch:!1,pending:ce,then:ne,catch:oe,value:2,blocks:[,,,]};return A(P=a[0].streamed.products,i),{c(){t=w("div"),r=w("h2"),e=$(o),l=$(" Produkte der Kategorie  "),s=$(n),c=$(" gefunden"),_=M(),f=w("ul"),i.block.c(),this.h()},l(d){t=C(d,"DIV",{class:!0});var u=S(t);r=C(u,"H2",{});var g=S(r);e=v(g,o),l=v(g," Produkte der Kategorie  "),s=v(g,n),c=v(g," gefunden"),g.forEach(m),u.forEach(m),_=T(d),f=C(d,"UL",{class:!0});var F=S(f);i.block.l(F),F.forEach(m),this.h()},h(){E(t,"class","px-2 m-2 border-2 "),E(f,"class","grid grid-cols-2 md:grid-cols-3")},m(d,u){b(d,t,u),y(t,r),y(r,e),y(r,l),y(r,s),y(r,c),b(d,_,u),b(d,f,u),i.block.m(f,i.anchor=null),i.mount=()=>f,i.anchor=null,h=!0},p(d,[u]){a=d,(!h||u&1)&&o!==(o=a[0].data.productQty+"")&&L(e,o),(!h||u&1)&&n!==(n=a[0].data.catname+"")&&L(s,n),i.ctx=a,u&1&&P!==(P=a[0].streamed.products)&&A(P,i)||V(i,a,u)},i(d){h||(k(i.block),h=!0)},o(d){for(let u=0;u<3;u+=1){const g=i.blocks[u];I(g)}h=!1},d(d){d&&(m(t),m(_),m(f)),i.block.d(),i.token=null,i=null}}}function le(a,t,r){let{data:o}=t;return a.$$set=e=>{"data"in e&&r(0,o=e.data)},a.$$.update=()=>{a.$$.dirty&1&&o.data.catid},[o]}class he extends G{constructor(t){super(),J(this,t,le,se,H,{data:0})}}export{he as component,ge as universal};
