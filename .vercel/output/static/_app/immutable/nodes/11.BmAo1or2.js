import{s as j}from"../chunks/supabaseClient.CCJhsT86.js";import{g as X}from"../chunks/categories.VNeXaOrY.js";import{s as Y,e as k,a as N,t as q,o as Z,c as b,f as m,g as V,b as B,d as L,m as v,h,i as I,j as P,n as _,p as T,q as x}from"../chunks/scheduler.CzaLFZzx.js";import{h as z,u as ee}from"../chunks/await_block.DdT5Fn5c.js";import{e as H}from"../chunks/each.D6YF6ztN.js";import{S as te,i as oe,t as $,b as E,g as ae,e as ne,c as J,a as Q,m as R,d as W}from"../chunks/index.C2gRMFDs.js";import{B as re}from"../chunks/book.BPTvf_Y4.js";import{S as le}from"../chunks/Spinner.6YvIMwKj.js";async function se(o){let t=[];const{data:n,error:l}=await j.from("books_categories").select("book_id").eq("category_id",o);return l?console.log("Fehler beim Abrufen der BookIds(catId)"):(console.log("Keine Fehler"),t=[...new Set(n.map(e=>e.book_id))]),t}async function ie(o){console.log("funktion call getCategoryNameById");const{data:t}=await j.from("categories").select("name").eq("id",o);return console.log("data ",t),t[0].name}async function ce(o){const{data:t,error:n}=await j.from("books").select().in("id",o);return n?null:t}async function de(){const{data:o,error:t}=await j.from("categories").select();return t?(console.log("Fehler in der Abfrage"),null):o}async function ue({params:o}){const t=o.catid,n=await se(parseInt(t)),l=await ie(parseInt(t)),e=de(),r=l+" Bücher | cdl-protokolle.com",a=await X(parseInt(t));return{data:{catid:t,catname:l,bookcategories:e,title:r,metaDescription:a},streamed:{books:ce(n)}}}const we=Object.freeze(Object.defineProperty({__proto__:null,load:ue},Symbol.toStringTag,{value:"Module"}));function U(o,t,n){const l=o.slice();return l[3]=t[n],l}function me(o){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function fe(o){let t,n,l=H(o[2]),e=[];for(let a=0;a<l.length;a+=1)e[a]=G(U(o,l,a));const r=a=>E(e[a],1,1,()=>{e[a]=null});return{c(){for(let a=0;a<e.length;a+=1)e[a].c();t=T()},l(a){for(let i=0;i<e.length;i+=1)e[i].l(a);t=T()},m(a,i){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(a,i);I(a,t,i),n=!0},p(a,i){if(i&1){l=H(a[2]);let s;for(s=0;s<l.length;s+=1){const p=U(a,l,s);e[s]?(e[s].p(p,i),$(e[s],1)):(e[s]=G(p),e[s].c(),$(e[s],1),e[s].m(t.parentNode,t))}for(ae(),s=l.length;s<e.length;s+=1)r(s);ne()}},i(a){if(!n){for(let i=0;i<l.length;i+=1)$(e[i]);n=!0}},o(a){e=e.filter(Boolean);for(let i=0;i<e.length;i+=1)E(e[i]);n=!1},d(a){a&&m(t),x(e,a)}}}function G(o){let t,n,l;return n=new re({props:{book:{slug:o[3].slug,id:o[3].id,title:o[3].title,img:o[3].img}}}),{c(){t=k("li"),J(n.$$.fragment),this.h()},l(e){t=b(e,"LI",{class:!0});var r=B(t);Q(n.$$.fragment,r),r.forEach(m),this.h()},h(){v(t,"class","my-2")},m(e,r){I(e,t,r),R(n,t,null),l=!0},p(e,r){const a={};r&1&&(a.book={slug:e[3].slug,id:e[3].id,title:e[3].title,img:e[3].img}),n.$set(a)},i(e){l||($(n.$$.fragment,e),l=!0)},o(e){E(n.$$.fragment,e),l=!1},d(e){e&&m(t),W(n)}}}function ge(o){let t,n,l,e;return n=new le({}),{c(){t=k("div"),J(n.$$.fragment),l=q(`
            Loading Books ...`),this.h()},l(r){t=b(r,"DIV",{class:!0});var a=B(t);Q(n.$$.fragment,a),l=L(a,`
            Loading Books ...`),a.forEach(m),this.h()},h(){v(t,"class","loading")},m(r,a){I(r,t,a),R(n,t,null),h(t,l),e=!0},p:_,i(r){e||($(n.$$.fragment,r),e=!0)},o(r){E(n.$$.fragment,r),e=!1},d(r){r&&m(t),W(n)}}}function he(o){let t,n,l,e,r,a,i,s=o[0].categories[o[1]].name+"",p,A,w,D=o[0].data.metaDescription+"",C,S,f,F,g;document.title=t=o[0].data.title;let d={ctx:o,current:null,token:null,hasCatch:!1,pending:ge,then:fe,catch:me,value:2,blocks:[,,,]};return z(F=o[0].streamed.books,d),{c(){n=k("meta"),e=N(),r=k("div"),a=k("h2"),i=q("Bücher der Kategorie  "),p=q(s),A=N(),w=k("div"),C=q(D),S=N(),f=k("ul"),d.block.c(),this.h()},l(u){const c=Z("svelte-1x4ga1y",document.head);n=b(c,"META",{name:!0,content:!0}),c.forEach(m),e=V(u),r=b(u,"DIV",{class:!0});var y=B(r);a=b(y,"H2",{});var K=B(a);i=L(K,"Bücher der Kategorie  "),p=L(K,s),K.forEach(m),A=V(y),w=b(y,"DIV",{});var M=B(w);C=L(M,D),M.forEach(m),y.forEach(m),S=V(u),f=b(u,"UL",{class:!0});var O=B(f);d.block.l(O),O.forEach(m),this.h()},h(){v(n,"name","description"),v(n,"content",l=o[0].data.metaDescription),v(r,"class","px-2 m-2 border-2 "),v(f,"class","grid grid-cols-2 md:grid-cols-3 bg-gray-100")},m(u,c){h(document.head,n),I(u,e,c),I(u,r,c),h(r,a),h(a,i),h(a,p),h(r,A),h(r,w),h(w,C),I(u,S,c),I(u,f,c),d.block.m(f,d.anchor=null),d.mount=()=>f,d.anchor=null,g=!0},p(u,[c]){o=u,(!g||c&1)&&t!==(t=o[0].data.title)&&(document.title=t),(!g||c&1&&l!==(l=o[0].data.metaDescription))&&v(n,"content",l),(!g||c&3)&&s!==(s=o[0].categories[o[1]].name+"")&&P(p,s),(!g||c&1)&&D!==(D=o[0].data.metaDescription+"")&&P(C,D),d.ctx=o,c&1&&F!==(F=o[0].streamed.books)&&z(F,d)||ee(d,o,c)},i(u){g||($(d.block),g=!0)},o(u){for(let c=0;c<3;c+=1){const y=d.blocks[c];E(y)}g=!1},d(u){u&&(m(e),m(r),m(S),m(f)),m(n),d.block.d(),d.token=null,d=null}}}function _e(o,t,n){let l,{data:e}=t;return o.$$set=r=>{"data"in r&&n(0,e=r.data)},o.$$.update=()=>{o.$$.dirty&1&&n(1,l=parseInt(e.data.catid)-1)},[e,l]}class De extends te{constructor(t){super(),oe(this,t,_e,he,Y,{data:0})}}export{De as component,we as universal};
