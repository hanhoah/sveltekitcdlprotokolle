import{s as q}from"../chunks/supabaseClient.CD4MZNEJ.js";import{s as z,e as I,t as w,a as B,c as P,b as C,d as $,f as _,g as F,l as E,i as v,h,j,n as g,m as A,o as M,N as W,O as G}from"../chunks/scheduler.DXrhz23f.js";import{h as H,u as J}from"../chunks/await_block.i5jR_Kl1.js";import{e as K}from"../chunks/each.D6YF6ztN.js";import{S as R,i as X,t as y,a as S,g as Y,c as Z,b as D,d as T,m as U,e as V}from"../chunks/index.Bmfu-QDF.js";import{P as x}from"../chunks/product.CMrH7TNJ.js";import{S as ee}from"../chunks/Spinner.D0BCRiYv.js";async function te(r){console.log("getProductIdsFromCatid, ",r);let t=[];const{data:a,error:n}=await q.from("products_categories").select("product_id").eq("category_id",r);return n?console.log("Fehler beim Abrufen der ProductIds(catId)"):t=[...new Set(a.map(e=>e.product_id))],t}function ae(){return[{id:5,name:"Ayurveda"},{id:6,name:"Aphrodisiaka"}]}async function re(r){const{count:t}=await q.from("products_categories").select("*",{count:"exact",head:!0}).eq("category_id",r);return t}async function oe(r){const{data:t}=await q.from("categories").select("name").eq("id",r);return t[0].name}async function ne(r){const{data:t,error:a}=await q.from("products").select().in("id",r);return a?null:t}async function le({params:r}){const t=r.catid,a=await te(parseInt(t)),n=await re(parseInt(t)),e=await oe(parseInt(t)),d=ae();return{data:{catid:t,catname:e,productcategories:d,productQty:n},streamed:{products:ne(a)}}}const ke=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"}));function N(r,t,a){const n=r.slice();return n[3]=t[a],n}function ce(r){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function se(r){let t,a,n=K(r[2]),e=[];for(let o=0;o<n.length;o+=1)e[o]=O(N(r,n,o));const d=o=>S(e[o],1,1,()=>{e[o]=null});return{c(){for(let o=0;o<e.length;o+=1)e[o].c();t=A()},l(o){for(let c=0;c<e.length;c+=1)e[c].l(o);t=A()},m(o,c){for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(o,c);v(o,t,c),a=!0},p(o,c){if(c&1){n=K(o[2]);let l;for(l=0;l<n.length;l+=1){const s=N(o,n,l);e[l]?(e[l].p(s,c),y(e[l],1)):(e[l]=O(s),e[l].c(),y(e[l],1),e[l].m(t.parentNode,t))}for(Y(),l=n.length;l<e.length;l+=1)d(l);Z()}},i(o){if(!a){for(let c=0;c<n.length;c+=1)y(e[c]);a=!0}},o(o){e=e.filter(Boolean);for(let c=0;c<e.length;c+=1)S(e[c]);a=!1},d(o){o&&_(t),M(e,o)}}}function O(r){let t,a,n,e=Q(r[3].id)+"",d,o,c,l;return o=new x({props:{product:{id:r[3].id,name:r[3].name,img:r[3].image}}}),{c(){t=I("div"),a=I("li"),n=new W(!1),d=B(),D(o.$$.fragment),c=B(),this.h()},l(s){t=P(s,"DIV",{class:!0});var i=C(t);a=P(i,"LI",{class:!0});var p=C(a);n=G(p,!1),d=F(p),T(o.$$.fragment,p),p.forEach(_),c=F(i),i.forEach(_),this.h()},h(){n.a=d,E(a,"class","my-2 relative"),E(t,"class","")},m(s,i){v(s,t,i),h(t,a),n.m(e,a),h(a,d),U(o,a,null),h(t,c),l=!0},p(s,i){(!l||i&1)&&e!==(e=Q(s[3].id)+"")&&n.p(e);const p={};i&1&&(p.product={id:s[3].id,name:s[3].name,img:s[3].image}),o.$set(p)},i(s){l||(y(o.$$.fragment,s),l=!0)},o(s){S(o.$$.fragment,s),l=!1},d(s){s&&_(t),V(o)}}}function ie(r){let t,a,n;return t=new ee({}),{c(){D(t.$$.fragment),a=w(`
          Lade Produkte ...`)},l(e){T(t.$$.fragment,e),a=$(e,`
          Lade Produkte ...`)},m(e,d){U(t,e,d),v(e,a,d),n=!0},p:g,i(e){n||(y(t.$$.fragment,e),n=!0)},o(e){S(t.$$.fragment,e),n=!1},d(e){e&&_(a),V(t,e)}}}function de(r){let t,a,n=r[0].data.productQty+"",e,d,o=r[0].data.catname+"",c,l,s,i,p,k,u={ctx:r,current:null,token:null,hasCatch:!1,pending:ie,then:se,catch:ce,value:2,blocks:[,,,]};return H(p=r[0].streamed.products,u),{c(){t=I("div"),a=I("h2"),e=w(n),d=w(" Produkte der Kategorie  "),c=w(o),l=w(" gefunden"),s=B(),i=I("ul"),u.block.c(),this.h()},l(f){t=P(f,"DIV",{class:!0});var m=C(t);a=P(m,"H2",{});var b=C(a);e=$(b,n),d=$(b," Produkte der Kategorie  "),c=$(b,o),l=$(b," gefunden"),b.forEach(_),m.forEach(_),s=F(f),i=P(f,"UL",{class:!0});var L=C(i);u.block.l(L),L.forEach(_),this.h()},h(){E(t,"class","px-2 m-2 border-2 "),E(i,"class","grid grid-cols-2 md:grid-cols-3")},m(f,m){v(f,t,m),h(t,a),h(a,e),h(a,d),h(a,c),h(a,l),v(f,s,m),v(f,i,m),u.block.m(i,u.anchor=null),u.mount=()=>i,u.anchor=null,k=!0},p(f,[m]){r=f,(!k||m&1)&&n!==(n=r[0].data.productQty+"")&&j(e,n),(!k||m&1)&&o!==(o=r[0].data.catname+"")&&j(c,o),u.ctx=r,m&1&&p!==(p=r[0].streamed.products)&&H(p,u)||J(u,r,m)},i(f){k||(y(u.block),k=!0)},o(f){for(let m=0;m<3;m+=1){const b=u.blocks[m];S(b)}k=!1},d(f){f&&(_(t),_(s),_(i)),u.block.d(),u.token=null,u=null}}}function Q(r){let t=r.split("-")[0],a="";switch(t){case"gvk":a="Kronenberg";break;case"wk":a="Waldkraft";break;default:a="Unknown"}return'<div class="border-2 absolute right-2 text-white rounded-md text-s p-1 text-center top-5 w-24 bg-purple-700 opacity-65" large color="green">'+a+"</div>"}function ue(r,t,a){let{data:n}=t;return r.$$set=e=>{"data"in e&&a(0,n=e.data)},r.$$.update=()=>{r.$$.dirty&1&&n.data.catid},[n]}class ve extends R{constructor(t){super(),X(this,t,ue,de,z,{data:0})}}export{ve as component,ke as universal};
