import{s as A}from"../chunks/supabaseClient.CCJhsT86.js";import{R as X}from"../chunks/config.B_h1yIO5.js";import{g as Y}from"../chunks/categories.VNeXaOrY.js";import{s as Z,e as k,a as N,t as q,o as x,c as b,f as d,g as V,b as B,d as T,m as v,h,i as y,j as O,n as _,p as P,q as ee}from"../chunks/scheduler.CzaLFZzx.js";import{h as R,u as te}from"../chunks/await_block.DdT5Fn5c.js";import{e as U}from"../chunks/each.D6YF6ztN.js";import{S as ae,i as oe,t as I,b as E,g as ne,e as re,c as G,a as J,m as Q,d as W}from"../chunks/index.C2gRMFDs.js";import{B as le}from"../chunks/book.BPTvf_Y4.js";import{S as se}from"../chunks/Spinner.6YvIMwKj.js";async function ie(a){console.log("funktion call getCategoryNameById");const{data:t}=await A.from("categories").select("name").eq("id",a);return console.log("data ",t),t[0].name}async function ce(a){const{data:t,error:n}=await A.from("books_categories_view").select().eq("category_id",a).order("prio").limit(X);return n?null:t}async function ue(){const{data:a,error:t}=await A.from("categories").select();return t?(console.log("Fehler in der Abfrage"),null):a}async function me({params:a}){const t=a.catid,n=await ie(parseInt(t)),l=ue(),e=n+" Bücher | cdl-protokolle.com",r=await Y(parseInt(t));return{data:{catid:t,catname:n,bookcategories:l,title:e,metaDescription:r},streamed:{books:ce(parseInt(t))}}}const De=Object.freeze(Object.defineProperty({__proto__:null,load:me},Symbol.toStringTag,{value:"Module"}));function z(a,t,n){const l=a.slice();return l[3]=t[n],l}function de(a){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function fe(a){let t,n,l=U(a[2]),e=[];for(let o=0;o<l.length;o+=1)e[o]=H(z(a,l,o));const r=o=>E(e[o],1,1,()=>{e[o]=null});return{c(){for(let o=0;o<e.length;o+=1)e[o].c();t=P()},l(o){for(let i=0;i<e.length;i+=1)e[i].l(o);t=P()},m(o,i){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(o,i);y(o,t,i),n=!0},p(o,i){if(i&1){l=U(o[2]);let s;for(s=0;s<l.length;s+=1){const p=z(o,l,s);e[s]?(e[s].p(p,i),I(e[s],1)):(e[s]=H(p),e[s].c(),I(e[s],1),e[s].m(t.parentNode,t))}for(ne(),s=l.length;s<e.length;s+=1)r(s);re()}},i(o){if(!n){for(let i=0;i<l.length;i+=1)I(e[i]);n=!0}},o(o){e=e.filter(Boolean);for(let i=0;i<e.length;i+=1)E(e[i]);n=!1},d(o){o&&d(t),ee(e,o)}}}function H(a){let t,n,l;return n=new le({props:{book:{slug:a[3].slug,id:a[3].id,title:a[3].title,img:a[3].img}}}),{c(){t=k("li"),G(n.$$.fragment),this.h()},l(e){t=b(e,"LI",{class:!0});var r=B(t);J(n.$$.fragment,r),r.forEach(d),this.h()},h(){v(t,"class","my-2")},m(e,r){y(e,t,r),Q(n,t,null),l=!0},p(e,r){const o={};r&1&&(o.book={slug:e[3].slug,id:e[3].id,title:e[3].title,img:e[3].img}),n.$set(o)},i(e){l||(I(n.$$.fragment,e),l=!0)},o(e){E(n.$$.fragment,e),l=!1},d(e){e&&d(t),W(n)}}}function ge(a){let t,n,l,e;return n=new se({}),{c(){t=k("div"),G(n.$$.fragment),l=q(`
            Loading Books ...`),this.h()},l(r){t=b(r,"DIV",{class:!0});var o=B(t);J(n.$$.fragment,o),l=T(o,`
            Loading Books ...`),o.forEach(d),this.h()},h(){v(t,"class","loading")},m(r,o){y(r,t,o),Q(n,t,null),h(t,l),e=!0},p:_,i(r){e||(I(n.$$.fragment,r),e=!0)},o(r){E(n.$$.fragment,r),e=!1},d(r){r&&d(t),W(n)}}}function he(a){let t,n,l,e,r,o,i,s=a[0].categories[a[1]].name+"",p,j,w,D=a[0].data.metaDescription+"",C,S,f,L,g;document.title=t=a[0].data.title;let u={ctx:a,current:null,token:null,hasCatch:!1,pending:ge,then:fe,catch:de,value:2,blocks:[,,,]};return R(L=a[0].streamed.books,u),{c(){n=k("meta"),e=N(),r=k("div"),o=k("h2"),i=q("Bücher der Kategorie  "),p=q(s),j=N(),w=k("div"),C=q(D),S=N(),f=k("ul"),u.block.c(),this.h()},l(m){const c=x("svelte-1x4ga1y",document.head);n=b(c,"META",{name:!0,content:!0}),c.forEach(d),e=V(m),r=b(m,"DIV",{class:!0});var $=B(r);o=b($,"H2",{});var M=B(o);i=T(M,"Bücher der Kategorie  "),p=T(M,s),M.forEach(d),j=V($),w=b($,"DIV",{});var F=B(w);C=T(F,D),F.forEach(d),$.forEach(d),S=V(m),f=b(m,"UL",{class:!0});var K=B(f);u.block.l(K),K.forEach(d),this.h()},h(){v(n,"name","description"),v(n,"content",l=a[0].data.metaDescription),v(r,"class","px-2 m-2 border-2 "),v(f,"class","grid grid-cols-2 md:grid-cols-3 bg-gray-100")},m(m,c){h(document.head,n),y(m,e,c),y(m,r,c),h(r,o),h(o,i),h(o,p),h(r,j),h(r,w),h(w,C),y(m,S,c),y(m,f,c),u.block.m(f,u.anchor=null),u.mount=()=>f,u.anchor=null,g=!0},p(m,[c]){a=m,(!g||c&1)&&t!==(t=a[0].data.title)&&(document.title=t),(!g||c&1&&l!==(l=a[0].data.metaDescription))&&v(n,"content",l),(!g||c&3)&&s!==(s=a[0].categories[a[1]].name+"")&&O(p,s),(!g||c&1)&&D!==(D=a[0].data.metaDescription+"")&&O(C,D),u.ctx=a,c&1&&L!==(L=a[0].streamed.books)&&R(L,u)||te(u,a,c)},i(m){g||(I(u.block),g=!0)},o(m){for(let c=0;c<3;c+=1){const $=u.blocks[c];E($)}g=!1},d(m){m&&(d(e),d(r),d(S),d(f)),d(n),u.block.d(),u.token=null,u=null}}}function _e(a,t,n){let l,{data:e}=t;return a.$$set=r=>{"data"in r&&n(0,e=r.data)},a.$$.update=()=>{a.$$.dirty&1&&n(1,l=parseInt(e.data.catid)-1)},[e,l]}class Ee extends ae{constructor(t){super(),oe(this,t,_e,he,Z,{data:0})}}export{Ee as component,De as universal};
