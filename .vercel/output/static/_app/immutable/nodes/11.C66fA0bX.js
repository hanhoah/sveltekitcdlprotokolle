import{s as Q}from"../chunks/supabaseClient.CD4MZNEJ.js";import{s as te,e as y,t as E,a as B,m as A,c as P,b as w,d as C,f as d,g as j,l as v,i as b,h as k,j as N,Q as re,o as X,n as I,H as ae,q as oe}from"../chunks/scheduler.DBuKuVba.js";import{h as O,u as ne}from"../chunks/await_block.CtqnqUU4.js";import{e as H}from"../chunks/each.D6YF6ztN.js";import{S as le,i as ie,t as L,a as z,g as se,c as ce,b as Y,d as Z,m as x,e as ee}from"../chunks/index.CsvtYcO8.js";import{p as ue}from"../chunks/stores.B5MaDiLU.js";import{g as T,P as fe}from"../chunks/shops.XWkl3EzL.js";import{S as de}from"../chunks/Spinner.BpP10mi9.js";async function pe(o){const{data:t,error:n}=await Q.from("categories").select("description").eq("id",o).single();try{return t&&t.description?t.description:null}catch{return null}}async function me(o){const{data:t,error:n}=await Q.from("productswithcategory").select("*").eq("category_id",o).order("name");if(n)console.log("Fehler beim Abrufen von Produkten getProductsByCategoryId lib/functions/products.ts");else return t}async function _e(o,t,n){console.log("page ist ",t);const r=(t-1)*n,{data:e,error:l}=await Q.from("productswithcategory").select("*").eq("category_id",o).order("name").range(r,r+n-1);return l?(console.error("Error fetching products:",l.message),null):e}function he(){return[{id:5,name:"Ayurveda"},{id:6,name:"Aphrodisiaka"}]}async function ge(o){const{count:t}=await Q.from("products_categories").select("*",{count:"exact",head:!0}).eq("category_id",o);return t}async function be(o){const{data:t}=await Q.from("categories").select("name").eq("id",o);return t[0].name}const ke=!1;async function ve(o,t,n){return t?_e(o,n,50):me(o)}async function ye({params:o,url:t}){const n=t.searchParams.get("page")||1,r=o.catid,e=await ge(parseInt(r)),l=await be(parseInt(r)),a=he(),i=await pe(parseInt(r)),s=`${l} - CDL Protokolle`,c=i||`Entdecken Sie eine Vielzahl von Produkten in der Kategorie ${l} auf CDL Protokolle.`,p=e>50,m=await ve(parseInt(r),p,n);return{data:{catid:r,catname:l,productcategories:a,productQty:e,description:i,title:s,metaDescription:c,page:n},streamed:{products:m}}}const Ve=Object.freeze(Object.defineProperty({__proto__:null,load:ye,prerender:ke},Symbol.toStringTag,{value:"Module"}));function Pe(){const o={root:null,rootMargin:"0px",threshold:.1},t=(r,e)=>{r.forEach(l=>{if(l.isIntersecting){const a=l.target.querySelector("img");a&&(a.loading="lazy"),e.unobserve(l.target)}})},n=new IntersectionObserver(t,o);document.querySelectorAll(".lazy-load").forEach(r=>{n.observe(r)})}function F(o,t,n){const r=o.slice();return r[6]=t[n],r}function U(o,t,n){const r=o.slice();return r[10]=t[n],r}function W(o){let t,n;return{c(){t=y("div"),n=E(o[3]),this.h()},l(r){t=P(r,"DIV",{id:!0});var e=w(t);n=C(e,o[3]),e.forEach(d),this.h()},h(){v(t,"id","description")},m(r,e){b(r,t,e),k(t,n)},p(r,e){e&8&&N(n,r[3])},d(r){r&&d(t)}}}function we(o){return{c:I,l:I,m:I,p:I,i:I,o:I,d:I}}function Ie(o){let t,n,r=H(o[9]),e=[];for(let a=0;a<r.length;a+=1)e[a]=G(U(o,r,a));const l=a=>z(e[a],1,1,()=>{e[a]=null});return{c(){for(let a=0;a<e.length;a+=1)e[a].c();t=A()},l(a){for(let i=0;i<e.length;i+=1)e[i].l(a);t=A()},m(a,i){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(a,i);b(a,t,i),n=!0},p(a,i){if(i&1){r=H(a[9]);let s;for(s=0;s<r.length;s+=1){const c=U(a,r,s);e[s]?(e[s].p(c,i),L(e[s],1)):(e[s]=G(c),e[s].c(),L(e[s],1),e[s].m(t.parentNode,t))}for(se(),s=r.length;s<e.length;s+=1)l(s);ce()}},i(a){if(!n){for(let i=0;i<r.length;i+=1)L(e[i]);n=!0}},o(a){e=e.filter(Boolean);for(let i=0;i<e.length;i+=1)z(e[i]);n=!1},d(a){a&&d(t),X(e,a)}}}function G(o){let t,n,r,e=T(o[10].id)+"",l,a,i,s;return a=new fe({props:{product:{id:o[10].id,name:o[10].name,img:o[10].image}}}),{c(){t=y("div"),n=y("li"),r=new ae(!1),l=B(),Y(a.$$.fragment),i=B(),this.h()},l(c){t=P(c,"DIV",{class:!0});var p=w(t);n=P(p,"LI",{class:!0});var m=w(n);r=oe(m,!1),l=j(m),Z(a.$$.fragment,m),m.forEach(d),i=j(p),p.forEach(d),this.h()},h(){r.a=l,v(n,"class","my-2 relative"),v(t,"class","lazy-load")},m(c,p){b(c,t,p),k(t,n),r.m(e,n),k(n,l),x(a,n,null),k(t,i),s=!0},p(c,p){(!s||p&1)&&e!==(e=T(c[10].id)+"")&&r.p(e);const m={};p&1&&(m.product={id:c[10].id,name:c[10].name,img:c[10].image}),a.$set(m)},i(c){s||(L(a.$$.fragment,c),s=!0)},o(c){z(a.$$.fragment,c),s=!1},d(c){c&&d(t),ee(a)}}}function Ee(o){let t,n,r;return t=new de({}),{c(){Y(t.$$.fragment),n=E(`
          Lade Produkte ...`)},l(e){Z(t.$$.fragment,e),n=C(e,`
          Lade Produkte ...`)},m(e,l){x(t,e,l),b(e,n,l),r=!0},p:I,i(e){r||(L(t.$$.fragment,e),r=!0)},o(e){z(t.$$.fragment,e),r=!1},d(e){e&&d(n),ee(t,e)}}}function J(o){let t,n=H(o[5](o[2])),r=[];for(let e=0;e<n.length;e+=1)r[e]=R(F(o,n,e));return{c(){t=y("div");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=P(e,"DIV",{class:!0});var l=w(t);for(let a=0;a<r.length;a+=1)r[a].l(l);l.forEach(d),this.h()},h(){v(t,"class","page-selector svelte-18pvoj2")},m(e,l){b(e,t,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(t,null)},p(e,l){if(l&54){n=H(e[5](e[2]));let a;for(a=0;a<n.length;a+=1){const i=F(e,n,a);r[a]?r[a].p(i,l):(r[a]=R(i),r[a].c(),r[a].m(t,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(e){e&&d(t),X(r,e)}}}function Ce(o){let t,n=o[6]+"",r,e;return{c(){t=y("a"),r=E(n),this.h()},l(l){t=P(l,"A",{href:!0,class:!0});var a=w(t);r=C(a,n),a.forEach(d),this.h()},h(){v(t,"href",e="/produkte/cat/"+o[4]+"?page="+o[6]),v(t,"class","page-number svelte-18pvoj2")},m(l,a){b(l,t,a),k(t,r)},p(l,a){a&4&&n!==(n=l[6]+"")&&N(r,n),a&20&&e!==(e="/produkte/cat/"+l[4]+"?page="+l[6])&&v(t,"href",e)},d(l){l&&d(t)}}}function $e(o){let t,n=o[6]+"",r;return{c(){t=y("span"),r=E(n),this.h()},l(e){t=P(e,"SPAN",{class:!0});var l=w(t);r=C(l,n),l.forEach(d),this.h()},h(){v(t,"class","page-number current-page svelte-18pvoj2")},m(e,l){b(e,t,l),k(t,r)},p(e,l){l&4&&n!==(n=e[6]+"")&&N(r,n)},d(e){e&&d(t)}}}function R(o){let t;function n(l,a){return l[6]==l[1]?$e:Ce}let r=n(o),e=r(o);return{c(){e.c(),t=A()},l(l){e.l(l),t=A()},m(l,a){e.m(l,a),b(l,t,a)},p(l,a){r===(r=n(l))&&e?e.p(l,a):(e.d(1),e=r(l),e&&(e.c(),e.m(t.parentNode,t)))},d(l){l&&d(t),e.d(l)}}}function Se(o){let t,n,r=o[0].data.productQty+"",e,l,a=o[0].data.catname+"",i,s,c,p,m,$,V,M=o[5](o[2]),q,D,_=o[3]&&W(o),g={ctx:o,current:null,token:null,hasCatch:!1,pending:Ee,then:Ie,catch:we,value:9,blocks:[,,,]};O($=o[0].streamed.products,g);let h=M&&J(o);return{c(){t=y("div"),n=y("h2"),e=E(r),l=E(" Produkte der Kategorie  "),i=E(a),s=E(" gefunden"),c=B(),_&&_.c(),p=B(),m=y("ul"),g.block.c(),V=B(),h&&h.c(),q=A(),this.h()},l(u){t=P(u,"DIV",{class:!0});var f=w(t);n=P(f,"H2",{});var S=w(n);e=C(S,r),l=C(S," Produkte der Kategorie  "),i=C(S,a),s=C(S," gefunden"),S.forEach(d),f.forEach(d),c=j(u),_&&_.l(u),p=j(u),m=P(u,"UL",{class:!0});var K=w(m);g.block.l(K),K.forEach(d),V=j(u),h&&h.l(u),q=A(),this.h()},h(){v(t,"class","px-2 m-2 border-2 "),v(m,"class","grid grid-cols-2 md:grid-cols-3")},m(u,f){b(u,t,f),k(t,n),k(n,e),k(n,l),k(n,i),k(n,s),b(u,c,f),_&&_.m(u,f),b(u,p,f),b(u,m,f),g.block.m(m,g.anchor=null),g.mount=()=>m,g.anchor=null,b(u,V,f),h&&h.m(u,f),b(u,q,f),D=!0},p(u,[f]){o=u,(!D||f&1)&&r!==(r=o[0].data.productQty+"")&&N(e,r),(!D||f&1)&&a!==(a=o[0].data.catname+"")&&N(i,a),o[3]?_?_.p(o,f):(_=W(o),_.c(),_.m(p.parentNode,p)):_&&(_.d(1),_=null),g.ctx=o,f&1&&$!==($=o[0].streamed.products)&&O($,g)||ne(g,o,f),f&4&&(M=o[5](o[2])),M?h?h.p(o,f):(h=J(o),h.c(),h.m(q.parentNode,q)):h&&(h.d(1),h=null)},i(u){D||(L(g.block),D=!0)},o(u){for(let f=0;f<3;f+=1){const S=g.blocks[f];z(S)}D=!1},d(u){u&&(d(t),d(c),d(p),d(m),d(V),d(q)),_&&_.d(u),g.block.d(),g.token=null,g=null,h&&h.d(u)}}}function qe(o,t,n){let r,e,l,a;console.log(ue);let{data:i}=t;re(()=>{Pe()});function s(c){if(c>50){let p=Math.ceil(c/50);return Array.from({length:p},(m,$)=>$+1)}else return null}return o.$$set=c=>{"data"in c&&n(0,i=c.data)},o.$$.update=()=>{o.$$.dirty&1&&n(4,r=i.data.catid),o.$$.dirty&1&&n(3,e=i.data.description),o.$$.dirty&1&&n(2,l=i.data.productQty),o.$$.dirty&1&&n(1,a=i.data.page)},[i,a,l,e,r,s]}class He extends le{constructor(t){super(),ie(this,t,qe,Se,te,{data:0})}}export{He as component,Ve as universal};
